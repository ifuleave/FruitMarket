<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sujin.fruit.repository.mapper.FruitProductMapper">
	<!-- <select id="findById" parameterType="Long"
	resultType="com.findjob.sample.domain.Sample">
    SELECT id, name
    FROM samples
    WHERE id = #{id}
  </select> 
  keyProperty="fruitId"
  -->
	<insert id="productSave" useGeneratedKeys="true">
		INSERT INTO FRUIT_PRODUCT (
									FRUIT_NAME,
									FRUIT_PRICE,
									FRUIT_AMOUNT,
									FRUITCARTEGORY_ID
									)
							VALUES (
									#{fruitName},
									#{fruitPrice},
									#{fruitAmount},
									#{fruitcategoryId}
									)

	</insert>

	<select id="fruitProductList">
		SELECT * FROM FRUIT_PRODUCT
	</select>
	<select id="fruitProductOne">
		SELECT * FROM FRUIT_PRODUCT WHERE FRUIT_ID = #{id}
	</select>
	<update id="fruitProductUpdate">
		UPDATE FRUIT_PRODUCT SET FRUIT_NAME = #{request.fruitName}, 
								 FRUIT_PRICE = #{request.fruitPrice},
								 FRUIT_AMOUNT = #{request.fruitAmount},
								 FRUITCARTEGORY_ID = #{request.fruitcartegoryId}
				WHERE FRUIT_ID = #{id}
	</update>
	<delete id="deleteFruitProduct">
		delete from fruit_product where fruit_id = #{id}
	</delete>
	<insert id="fruitProductOrder" parameterType="com.sujin.fruit.domain.FruitOrder" useGeneratedKeys="true"  keyProperty="fruitorderId" keyColumn="FRUITORDER_ID">
				INSERT INTO FRUIT_ORDER (
									MEMBER_ID,
									DELIVERY_ID

									)
							VALUES (
									#{memberId},
									#{deliveryId}
									)
	</insert>
	<update id="fruitProductChangeAmount">
		update fruit_product set fruit_amount = fruit_amount - #{fruitAmount} where fruit_id = #{fruitId}
	</update>
	
	<insert id="orderDetailSave" useGeneratedKeys="true">
		INSERT INTO orderdetails (
									ORDERDETAILS_PRICE,
									ORDERDETAILS_AMOUNT,
									FRUITORDER_ID,
									FRUIT_ID
									)
							VALUES (
									#{orderDetailsPrice},
									#{orderDetailsAmount},
									#{fruitOrderId},
									#{fruitId}
									)
	</insert>
	
	<select id="getFruitPoductOrderId" resultType="long">
		select FRUITORDER_ID from fruit_order where FRUITORDER_ID = #{fruitOrderId};
	</select>
</mapper>

